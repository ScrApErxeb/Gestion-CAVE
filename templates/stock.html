<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion du stock</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

</head>
<body class="page-content">

    <div class="page-header">
        <h2>üìã Gestion du stock</h2>
    </div>

    <!-- ‚ö†Ô∏è Produits en stock critique ‚Äî PRIORITAIRE -->
    <div class="dashboard-section">
        <h3>‚ö†Ô∏è Produits en stock critique</h3>
        <div class="table-responsive">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Produit</th>
                        <th>Stock actuel</th>
                        <th>Seuil d'alerte</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="alertesTable"></tbody>
            </table>
        </div>
    </div>

    <!-- Actions rapides -->
    <div class="dashboard-section">
        <h3>Actions rapides</h3>
        <div class="actions-buttons">
            <button class="btn btn-success" onclick="showModal('entreeModal')">üì• Entr√©e de stock</button>
            <button class="btn btn-warning" onclick="showModal('sortieModal')">üì§ Sortie de stock</button>
            <button class="btn btn-info" onclick="showModal('ajustementModal')">üîß Ajustement</button>
        </div>
    </div>

    <!-- üìú Historique des mouvements -->
    <div class="dashboard-section">
        <h3>üìú Historique des mouvements</h3>
        <div class="table-responsive">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Produit</th>
                        <th>Type</th>
                        <th>Quantit√©</th>
                        <th>Stock avant</th>
                        <th>Stock apr√®s</th>
                        <th>Utilisateur</th>
                        <th>Commentaire</th>
                    </tr>
                </thead>
                <tbody id="mouvementsTable"></tbody>
            </table>
        </div>
    </div>

    <!-- Modals inchang√©s -->
    <!-- Modal Entr√©e de stock -->
    <div id="entreeModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('entreeModal')">&times;</span>
            <h3>üì• Entr√©e de stock</h3>
            <form id="entreeForm" onsubmit="enregistrerEntree(event)">
                <div class="form-group">
                    <label for="produitEntree">Produit *</label>
                    <select id="produitEntree" required>
                        <option value="">S√©lectionner un produit</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="quantiteEntree">Quantit√© *</label>
                    <input type="number" id="quantiteEntree" min="1" required>
                </div>
                <div class="form-group">
                    <label for="referenceEntree">R√©f√©rence</label>
                    <input type="text" id="referenceEntree">
                </div>
                <div class="form-group">
                    <label for="commentaireEntree">Commentaire</label>
                    <textarea id="commentaireEntree" rows="2"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('entreeModal')">Annuler</button>
                    <button type="submit" class="btn btn-success">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Sortie -->
    <div id="sortieModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('sortieModal')">&times;</span>
            <h3>üì§ Sortie de stock</h3>
            <form id="sortieForm" onsubmit="enregistrerSortie(event)">
                <div class="form-group">
                    <label for="produitSortie">Produit *</label>
                    <select id="produitSortie" required>
                        <option value="">S√©lectionner un produit</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="quantiteSortie">Quantit√© *</label>
                    <input type="number" id="quantiteSortie" min="1" required>
                </div>
                <div class="form-group">
                    <label for="commentaireSortie">Raison *</label>
                    <textarea id="commentaireSortie" rows="2" required placeholder="Ex: Perte, casse, don..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('sortieModal')">Annuler</button>
                    <button type="submit" class="btn btn-warning">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Ajustement -->
    <div id="ajustementModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('ajustementModal')">&times;</span>
            <h3>üîß Ajustement de stock</h3>
            <form id="ajustementForm" onsubmit="enregistrerAjustement(event)">
                <div class="form-group">
                    <label for="produitAjust">Produit *</label>
                    <select id="produitAjust" required onchange="afficherStockActuel()">
                        <option value="">S√©lectionner un produit</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Stock actuel</label>
                    <input type="text" id="stockActuel" readonly>
                </div>
                <div class="form-group">
                    <label for="nouveauStock">Nouveau stock *</label>
                    <input type="number" id="nouveauStock" min="0" required>
                </div>
                <div class="form-group">
                    <label for="commentaireAjust">Commentaire *</label>
                    <textarea id="commentaireAjust" rows="2" required placeholder="Ex: Inventaire physique..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('ajustementModal')">Annuler</button>
                    <button type="submit" class="btn btn-info">Ajuster</button>
                </div>
            </form>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/stock.js') }}"></script>
</body>
</html>
