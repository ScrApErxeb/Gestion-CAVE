<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des factures</title>
    <link rel="stylesheet" href="static/css/facture.css">
</head>
<body>
    <div class="page-header">
        <h2>üìÑ Gestion des factures</h2>
        <button class="btn btn-primary" onclick="showModal('createFactureModal')">+ Nouvelle facture</button>
    </div>

    <div class="filters">
        <select id="filtreStatut" onchange="chargerFactures()">
            <option value="">Tous les statuts</option>
            <option value="impayee">Impay√©es</option>
            <option value="partielle">Partielles</option>
            <option value="payee">Pay√©es</option>
        </select>
        <input type="text" id="searchAbonne" placeholder="Rechercher un abonn√©..." onkeyup="chargerFactures()">
    </div>

    <div class="table-responsive">
        <table class="data-table">
            <thead>
                <tr>
                    <th>N¬∞ Facture</th>
                    <th>Date</th>
                    <th>Abonn√©</th>
                    <th>Montant TTC</th>
                    <th>Pay√©</th>
                    <th>Reste</th>
                    <th>Statut</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="facturesTable"></tbody>
        </table>
    </div>

    <!-- Modal Cr√©er Facture -->
    <div id="createFactureModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('createFactureModal')">&times;</span>
            <h3>Cr√©er une nouvelle facture</h3>
            <form id="factureForm" onsubmit="creerFacture(event)">
                <div class="form-group">
                    <label for="abonneFacture">Abonn√© *</label>
                    <select id="abonneFacture" required onchange="chargerConsommationsNonFacturees()">
                        <option value="">S√©lectionner un abonn√©</option>
                    </select>
                </div>
                <div id="consommationsSection" style="display:none;">
                    <h4>Consommations non factur√©es</h4>
                    <div id="consommationsList"></div>
                    <div class="total-selected">
                        <strong>Total s√©lectionn√©: <span id="totalFacture">0</span> FCFA</strong>
                    </div>
                </div>
                <div class="form-group">
                    <label for="dateEcheance">Date d'√©ch√©ance</label>
                    <input type="date" id="dateEcheance">
                </div>
                <div class="form-group">
                    <label for="noteFacture">Note</label>
                    <textarea id="noteFacture" rows="2"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('createFactureModal')">Annuler</button>
                    <button type="submit" class="btn btn-primary">Cr√©er la facture</button>
                </div>
            </form>
        </div>
    </div>


    <!-- Modal D√©tails Facture -->
    <div id="detailsFactureModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('detailsFactureModal')">&times;</span>
            <h3>D√©tails de la facture</h3>
            <p><strong>Abonn√© :</strong> <span id="modalFactureAbonne"></span></p>
            <p><strong>Montant total :</strong> <span id="modalFactureMontant"></span> FCFA</p>
            <p><strong>Montant pay√© :</strong> <span id="modalFacturePaye"></span> FCFA</p>
            <p><strong>Reste √† payer :</strong> <span id="modalFactureReste"></span> FCFA</p>
            <p><strong>Date d‚Äô√©mission :</strong> <span id="modalFactureDate"></span></p>
            <p><strong>Mode de paiement :</strong> <span id="modalFactureMode"></span></p>
            <p><strong>R√©f√©rence :</strong> <span id="modalFactureRef"></span></p>
            <p><strong>Re√ßu par :</strong> <span id="modalFactureUser"></span></p>
            <p><strong>Note :</strong> <span id="modalFactureNote"></span></p>
        </div>
    </div>


    <script src="static/js/facture.js"></script>
</body>
</html>
