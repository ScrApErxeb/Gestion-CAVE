# ğŸ· Cave Gestion - SystÃ¨me de Gestion de Cave

Application web complÃ¨te pour la gestion d'une cave : ventes, abonnÃ©s, stock, factures et paiements.

## ğŸ“‹ FonctionnalitÃ©s

### âœ… Gestion des abonnÃ©s
- CrÃ©ation et modification des abonnÃ©s
- Recherche par nom, numÃ©ro ou tÃ©lÃ©phone
- Suivi du solde dÃ»
- Historique des consommations

### âœ… Gestion des produits
- Catalogue de produits avec catÃ©gories
- Prix d'achat et prix de vente
- Gestion des fournisseurs
- Calcul automatique des marges

### âœ… Gestion du stock
- EntrÃ©es/sorties de stock
- Ajustements d'inventaire
- Alertes de stock critique
- Historique complet des mouvements

### âœ… Enregistrement des consommations
- Vente rapide
- Mise Ã  jour automatique du stock
- Association aux abonnÃ©s
- PrÃªt pour facturation

### âœ… Facturation
- GÃ©nÃ©ration automatique de factures
- NumÃ©rotation automatique
- Calcul de TVA (18% par dÃ©faut)
- Suivi des factures impayÃ©es

### âœ… Gestion des paiements
- Multiples modes de paiement (espÃ¨ces, mobile money, chÃ¨que, carte)
- Paiements partiels
- Mise Ã  jour automatique du statut des factures
- Statistiques de paiements

### âœ… Tableau de bord
- Vue d'ensemble des activitÃ©s
- Statistiques en temps rÃ©el
- Alertes de stock critique
- DerniÃ¨res transactions

## ğŸš€ Installation

### PrÃ©requis
- Python 3.8 ou supÃ©rieur
- pip (gestionnaire de paquets Python)

### Ã‰tapes d'installation

1. **Cloner ou tÃ©lÃ©charger le projet**
```bash
cd cave_gestion
```

2. **CrÃ©er un environnement virtuel (recommandÃ©)**
```bash
python -m venv venv

# Activer l'environnement (Windows)
venv\Scripts\activate

# Activer l'environnement (Linux/Mac)
source venv/bin/activate
```

3. **Installer les dÃ©pendances**
```bash
pip install -r requirements.txt
```

4. **CrÃ©er la structure des dossiers**
```bash
mkdir database
mkdir routes
mkdir core
mkdir static
mkdir templates
```

5. **Lancer l'application**
```bash
python app.py
```

Le navigateur s'ouvrira automatiquement sur `http://127.0.0.1:5000/`

## ğŸ‘¤ Connexion par dÃ©faut

- **Utilisateur**: `admin`
- **Mot de passe**: `admin123`

âš ï¸ **IMPORTANT**: Changez le mot de passe par dÃ©faut aprÃ¨s la premiÃ¨re connexion !

## ğŸ“ Structure du projet

```
cave_gestion/
â”‚
â”œâ”€â”€ app.py                  # Point d'entrÃ©e de l'application
â”œâ”€â”€ models.py               # ModÃ¨les de donnÃ©es (SQLAlchemy)
â”œâ”€â”€ requirements.txt        # DÃ©pendances Python
â”‚
â”œâ”€â”€ core/                   # Logique mÃ©tier (Ã  implÃ©menter si nÃ©cessaire)
â”‚
â”œâ”€â”€ routes/                 # Routes API Flask
â”‚   â”œâ”€â”€ api_abonnes.py
â”‚   â”œâ”€â”€ api_produits.py
â”‚   â”œâ”€â”€ api_factures.py
â”‚   â”œâ”€â”€ api_paiements.py
â”‚   â”œâ”€â”€ api_consommations.py
â”‚   â””â”€â”€ api_stock.py
â”‚
â”œâ”€â”€ templates/              # Templates HTML
â”‚   â”œâ”€â”€ login.html
â”‚   â”œâ”€â”€ home.html
â”‚   â”œâ”€â”€ dashboard.html
â”‚   â”œâ”€â”€ abonnes.html
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ static/                 # Fichiers statiques
â”‚   â””â”€â”€ style.css
â”‚
â””â”€â”€ database/               # Base de donnÃ©es SQLite
    â””â”€â”€ cave.db
```

## ğŸ” Gestion des utilisateurs

### RÃ´les disponibles

1. **Admin** - AccÃ¨s complet Ã  toutes les fonctionnalitÃ©s
2. **Gestionnaire** - Gestion des abonnÃ©s, produits, factures, stock
3. **Caissier** - Enregistrement des ventes, consommations, paiements

### CrÃ©er un nouvel utilisateur (via Python)

```python
from app import app
from models import db, User

with app.app_context():
    user = User(
        username='nom_utilisateur',
        role='caissier',  # ou 'gestionnaire', 'admin'
        nom_complet='Nom Complet'
    )
    user.set_password('mot_de_passe')
    db.session.add(user)
    db.session.commit()
```

## ğŸ’¾ Sauvegarde des donnÃ©es

La base de donnÃ©es est stockÃ©e dans `database/cave.db`. Pour sauvegarder vos donnÃ©es :

1. **Sauvegarde manuelle**
```bash
# Copier le fichier de base de donnÃ©es
cp database/cave.db database/cave_backup_$(date +%Y%m%d).db
```

2. **Sauvegarde automatique recommandÃ©e**
   - Configurez une tÃ¢che planifiÃ©e (cron/Task Scheduler)
   - Copiez rÃ©guliÃ¨rement `cave.db` vers un emplacement sÃ©curisÃ©

## ğŸ› ï¸ Configuration

### Modifier les paramÃ¨tres de TVA

Dans la base de donnÃ©es, table `parametres_globaux`:
- `taux_tva_defaut`: Taux de TVA par dÃ©faut (18.0%)

### Personnaliser les informations de la cave

Modifiez la table `parametres_globaux`:
- `nom_cave`: Nom de votre cave
- `adresse`: Adresse complÃ¨te
- `telephone`: NumÃ©ro de tÃ©lÃ©phone
- `email`: Email de contact
- `ifu`: Identifiant Fiscal Unique
- `rccm`: Registre du Commerce

## ğŸ“Š API REST

L'application expose des API REST pour toutes les fonctionnalitÃ©s:

### AbonnÃ©s
- `GET /api/abonnes` - Liste des abonnÃ©s
- `POST /api/abonnes` - CrÃ©er un abonnÃ©
- `PUT /api/abonnes/<id>` - Modifier un abonnÃ©
- `DELETE /api/abonnes/<id>` - DÃ©sactiver un abonnÃ©

### Produits
- `GET /api/produits` - Liste des produits
- `POST /api/produits` - CrÃ©er un produit
- `PUT /api/produits/<id>` - Modifier un produit

### Factures
- `GET /api/factures` - Liste des factures
- `POST /api/factures` - CrÃ©er une facture
- `GET /api/factures/<id>` - DÃ©tails d'une facture

### Paiements
- `GET /api/paiements` - Liste des paiements
- `POST /api/paiements` - Enregistrer un paiement

### Consommations
- `GET /api/consommations` - Liste des consommations
- `POST /api/consommations` - Enregistrer une consommation

### Stock
- `GET /api/stock/mouvements` - Historique des mouvements
- `POST /api/stock/entree` - EntrÃ©e de stock
- `POST /api/stock/sortie` - Sortie de stock
- `POST /api/stock/ajustement` - Ajustement de stock

## ğŸ› RÃ©solution de problÃ¨mes

### L'application ne dÃ©marre pas
- VÃ©rifiez que toutes les dÃ©pendances sont installÃ©es: `pip install -r requirements.txt`
- VÃ©rifiez que le dossier `database/` existe

### Erreur de base de donnÃ©es
- Supprimez `database/cave.db` et relancez l'application (cela rÃ©initialisera la base)
- La base sera recrÃ©Ã©e avec l'utilisateur admin par dÃ©faut

### Le navigateur ne s'ouvre pas automatiquement
- Ouvrez manuellement: `http://127.0.0.1:5000/`

## ğŸ“ Notes importantes

1. **SÃ©curitÃ©**
   - Changez le SECRET_KEY dans `app.py` en production
   - Utilisez des mots de passe forts
   - Ne partagez pas le fichier de base de donnÃ©es

2. **Performance**
   - SQLite convient pour une utilisation locale
   - Pour plusieurs utilisateurs simultanÃ©s, considÃ©rez PostgreSQL ou MySQL

3. **Sauvegarde**
   - Sauvegardez rÃ©guliÃ¨rement `database/cave.db`
   - Testez vos sauvegardes

## ğŸ“ Support

Pour toute question ou problÃ¨me:
- Consultez la documentation dans ce fichier
- VÃ©rifiez les logs de l'application
- Contactez votre administrateur systÃ¨me

## ğŸ“„ Licence

Ce logiciel est fourni "tel quel" sans garantie d'aucune sorte.

---

**Version**: 1.0  
**Date**: 2025  
**DÃ©veloppÃ© pour**: Gestion de cave locale